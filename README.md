# ML_choosing_the_location_for_the_well

## Описание проекта:

Добывающей компании «ГлавРосГосНефть» нужно решить, где бурить новую скважину. Предоставлены пробы нефти в трёх регионах: в каждом 100 000 месторождений, где измерили качество нефти и объём её запасов. 

### Шаги для выбора локации:

- В избранном регионе ищут месторождения, для каждого определяют значения признаков;
- Строят модель и оценивают объём запасов;
- Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;
- Прибыль равна суммарной прибыли отобранных месторождений.

### Условия задачи:

- Для обучения модели подходит только линейная регрессия.
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
-  При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

## Цель исследования:

1. Построить модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль.
2. Проанализировать возможную прибыль и риски техникой *Bootstrap.*

### В работе используются следующие модели:

- LinearRegression — линейная регрессия
- DecisionTreeRegressor  — деревья решений для задач регрессии

## Как запустить проект

- Открыть файл `ML_choosing_the_location_for_the_well.ipynb` в GitHub
  
или
- Скачайте и запустите файл `ML_choosing_the_location_for_the_well.ipynb` или ноутбук с аналогичным кодом в Jupyter. Данные находятся в в папке `data_files`. При чтении файлов укажите свой путь к файлам в коде. 


## Краткие результаты

По итогам работы `GridSearchCV` мы получили модели `LinearRegression` с методом масштабирования `StandardScaler()` для всех трех регионов.

Рассчитали прибыль и риски для полученного объёма сырья в каждом регионе:

1. Получили следующие данные по объему сырья для безубыточной разработки новой скважины:

    - Достаточный объём сырья для безубыточной разработки новой скважины составляет 111.11 тыс. баррелей.
    - Наибольшими средними объёмами запасов в скважине обладает 3-й регион в размере 95 тыс. баррелей. Однако ни в одном регионе средний объем запасов не достигает минимальной отметки для безубыточной разработки новой скважины в 111.11 тыс. баррелей.

2. С помощью техники Bootstrap с 1000 выборок, мы смогли найти распределение прибыли, так же нашли среднюю прибыль, 95%-й доверительный интервал и риск убытков для каждого региона.

    - Для разработки скважин лучшим является 2-й регион (датасет geo_data_1). Добыча в данном регионе принесет наибольшую среднюю прибыль в размере 435 439 669.46 руб.. Данный регион имеет наименьшую вероятность убытков в 1.9 %. С вероятностью 95% прибыль во 2-м регионе будет находиться в диапазоне от 25 316 237.21 до 832 287 542.52 руб.
